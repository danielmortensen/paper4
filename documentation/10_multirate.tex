\section{Constrained Schedule\label{sec:constrainedSchedule}}
Up to this point, we have computed the ``optimal'' schedule which assumes any bus can charge without regard to the number of chargers. We then separate buses into groups to reduce the scope of the problem and treat each sub-problem separately while we defragment and assign each charge session to specific chargers before determining the final start and stop times for each bus's charge session.
\par The final step in this process is to determine how the energy will be delivered so that cost is minimised. Begin with constraints for bus power, energy, and cost from Section \ref{sec:unconstrainedSchedule} that are expressed as equations \ref{eqn:obj:power2}, \ref{eqn:battery:busPower}, \ref{eqn:objective:pt}, \ref{eqn:objective:p15}, \ref{eqn:objective:pFac}, \ref{eqn:objective:pDem} and \ref{eqn:objective:energy}. Next, include constraints for energy so that the energy for each charge session is properly delivered using a modified version of Eqn. \ref{eqn:defragmentation:active} so that
\begin{equation}
	\mathbf{b}(i,:)\rho(i,r) = \psi(i,r)
\end{equation}
where $\psi(i,r)$ is the required energy for bus $i$ during rest period $r$ as computed from the solution of the De-Fragmentation problem.
\section{Constrained Smooth Schedule\label{sec:constrainedSmoothSchedule}}
 \par The results of the Charger-Constrained problem will contain the same on-off defects as the solution from the Unconstrained program which can be managed using a similar method as before where we re-run the same program as before but make two changes. The first change constrains the objective so that it achieves the optimal cost. The second minimises differences between charge rates at adjacent time steps using the smoothing objective from Eqn. \ref{eqn:objective:smooth}.
